# 'pmm' Package

## Description

A package for percona PMM.
PMM is an open source database monitoring, observability and management tool.

## Values

### Percona Monitoring and Management (PMM) parameters

| Name                                 | Description                                                                                                                                                                                                                                   | Value                |
| ------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |----------------------|
| `pmm.image.repository`                   | PMM image repository                                                                                                                                                                                                                          | `percona/pmm-server` |
| `pmm.image.pullPolicy`                   | PMM image pull policy                                                                                                                                                                                                                         | `IfNotPresent`       |
| `pmm.image.tag`                          | PMM image tag (immutable tags are recommended)                                                                                                                                                                                                | `2.42.0`             |
| `pmm.image.imagePullSecrets`             | Global Docker registry secret names as an array                                                                                                                                                                                               | `[]`                 |
| `pmm.pmmEnv.DISABLE_UPDATES`             | Disables a periodic check for new PMM versions as well as ability to apply upgrades using the UI (need to be disabled in k8s environment as updates rolled with helm/container update)                                                        | `1`                  |
| `pmm.pmmResources`                       | optional [Resources](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/) requested for [PMM container](https://docs.percona.com/percona-monitoring-and-management/setting-up/server/index.html#set-up-pmm-server) | `{}`                 |
                                                                                                                                                           | `6`                  |

### PMM secrets

| Name                  | Description                                                                                                                                                                        | Value        |
| --------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------ |
| `pmm.secret.name`         | Defines the name of the k8s secret that holds passwords and other secrets                                                                                                          | ` ` |
| `pmm.secret.annotations`  | Defines the annotations of the k8s secret that holds passwords and other secrets                                                                                                   | `{}`         |
| `pmm.secret.create`       | If true then secret will be generated by Helm chart. Otherwise it is expected to be created by user.                                                                               | `true`       |
| `pmm.secret.pmm_password` | Initial PMM password - it changes only on the first deployment, ignored if PMM was already provisioned and just restarted. If PMM admin password is not set, it will be generated. | `""`         |
| `pmm.certs`               | Optional certificates, if not provided PMM would use generated self-signed certificates,                                                                                           | `{}`         |


### PMM network configuration

| Name                              | Description                                                                                                                                    | Value                 |
| --------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------- | --------------------- |
| `pmm.ingress.enabled`                 | -- Enable ingress controller resource                                                                                                          | `false`               |
| `pmm.ingress.annotations`             | -- Ingress annotations configuration                                                                                                           | `{}`                  |
| `pmm.ingress.community.annotations`   | -- Ingress annotations configuration for community managed ingress (nginxInc = false)                                                          | `{}`                  |
| `pmm.ingress.ingressClassName`        | -- Sets the ingress controller class name to use.                                                                                              | `""`                  |
| `pmm.ingress.hosts[0].host`           | hostname                                                                                                                                       | ` ` |
| `pmm.ingress.hosts[0].paths`          | path mapping                                                                                                                                   | `[]`                  |
| `pmm.ingress.pathType`                | -- How ingress paths should be treated.                                                                                                        | `Prefix`              |
| `pmm.ingress.tls`                     | -- Ingress TLS configuration                                                                                                                   | `[]`                  |


### PMM storage configuration

| Name                       | Description                                                                                                                                                                             | Value         |
| -------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------- |
| `pmm.storage.name`             | name of PVC                                                                                                                                                                             | ` ` |
| `pmm.storage.storageClassName` | optional PMM data Persistent Volume Storage Class                                                                                                                                       | `""`          |
| `pmm.storage.size`             | size of storage on number of monitored services and data retention | `10Gi`        |
| `pmm.storage.dataSource`       | VolumeSnapshot to start from                                                                                                                                                            | `{}`          |
| `pmm.storage.selector`         | select existing PersistentVolume                                                                                                                                                        | `{}`          |


### PMM kubernetes configurations

| Name                         | Description                                                                                                         | Value                 |
| ---------------------------- | ------------------------------------------------------------------------------------------------------------------- | --------------------- |
| `pmm.serviceAccount.create`      | Specifies whether a ServiceAccount should be created                                                                | `true`                |
| `pmm.serviceAccount.annotations` | Annotations for service account. Evaluated as a template. Only used if `create` is `true`.                          | `{}`                  |
| `pmm.serviceAccount.name`        | Name of the service account to use. If not set and create is true, a name is generated using the fullname template. | ` `                   |
| `pmm.podAnnotations`             | Pod annotations                                                                                                     | `{}`                  |
| `pmm.podSecurityContext`         | Configure Pods Security Context                                                                                     | `{}`                  |
| `pmm.securityContext`            | Configure Container Security Context                                                                                | `{}`                  |
| `pmm.nodeSelector`               | Node labels for pod assignment                                                                                      | `{}`                  |
| `pmm.tolerations`                | Tolerations for pod assignment                                                                                      | `[]`                  |
| `pmm.affinity`                   | Affinity for pod assignment                                                                                         | `{}`                  |



### PMM admin password

PMM admin password would be set only on the first deployment. That setting is ignored if PMM was already provisioned and just restarted and/or updated. In real-life situations it is recommended to create the secret manually before the release and set `secret.create` to false. The chart then won't overwrite secret during install or upgrade and values.yaml won't contain any secret.

If PMM admin password is not set explicitly (default), it will be generated.

To get admin password execute:

```sh
kubectl get secret < SECRET_NAME > -o jsonpath='{.data.PMM_ADMIN_PASSWORD}' | base64 --decode
```